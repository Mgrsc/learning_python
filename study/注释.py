

# WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWW      WWWWWW      WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWW      WWWWWW      WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWW      WWWWWW      WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWW       WWWW       WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWW       WWWW       WWWW     W   WWW   W   WWW      WWWW       WW+++++++WWWWWW
# WWWWWWWWWWWWWWWW       WWWW       WWW          WWW       W        WWW        WW+++++++WWWWWW
# WWWWWWWWWWWWWWWW        WW   W    WW           WWW       W    WW  WW         WW+++++++WWWWWW
# WWWWWWWWWWWWWWWW        WW   W    WW    WWW    WWW    WWWW    WWWWWW    WWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWW    W   W    W    WW    WWWW   WWW    WWWW      WWWW   WWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWW    W       WW    WW   WWWWW   WWW   WWWWWW       W    WWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWW    WW      WW    WW   WWWWW   WWW   WWWWWWW      WW   WWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWW    WW      WW    WW    WWW    WWW   WWWWWWWWWW    W    WWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWW    WW     WWW    WW     W     WWW   WWWWW  WWW    W     WW  WW+++++++WWWWWW
# WWWWWWWWWWWWWWWW    WWW    WWW    WWW          WWW   WWWWW        WWW        WW+++++++WWWWWW
# WWWWWWWWWWWWWWWW    WWW    WWW    WWW      W   WWW   WWWWW       WWWWW       WW+++++++WWWWWW
# WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW    WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW    WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW   W     WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW         WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW       WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW+++++++WWWWWW
# WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW+++++++WWWWWW


#             .^!)cCCUXzYUYzccXUJJJYr\[i^           I
#           :]/ff/\([+ilII;:;l>~<>i<}xYUn\]"        I
#         ;(vcx{"                    '!{jcYx}"      I
#       '[cQQJzuxnj)<"     .:-)trnur(>'  ^>tx),.    I
#      ;(JqpQ       z].  "tQZJ      Cu}:  'ixY/^    I
#     +YmbdJ /j|_    OQ[.`/qwXtjd     n0wv;  :cmJ-  I
#    ./q*#q\ ~)|-    Qbv`,uOz}?(      YZc!  "jLU/^  I
#    InZppZz        uZQ? ;cwQj        0Zx;   <jux?. I
#    -xzn))z        QQu?. .I(Y       Lu[:    '(uc\^ I
#   ,/rt-  l{fnvccf[!`      :-rvvzXcf],      ')vc|^ I
#   lfj/+`     ...                ..         ')xr<  I
#   .+jvjl         ^I!+{)|/t(_;'21             ;rv/ I
#    '/QU]        ?uJ           ct+"          .{CJ\ I
#     +UUf"      >tj            nzfi         <vQU]  I
#     ^[uXu]`  '}Yz              z/i.     "}uXr_`   I
#      .-XmU)" .{QO              bqc;   "?xYv]"     I
#        :/vji  ^}\|1[]]_+_??+~?/zn?. '+jXX/i       I
#       '!)[;.                   .   !\ct-;.        I
#     .!/cnI                       l/CC\"           I
#   .l1xr|~.                      ^\Xc|,            I
#    `I>,'                         ^:^              I


#  __ __                    
# |  \  \ ___  _ _  ___ ___ 
# |     |/ . || '_><_-</ | '
# |_|_|_|\_. ||_|  /__/\_|_.
#        <___'              
# Have fun. Don't forget to book


                            
#   /\/\   __ _ _ __ ___  ___ 
#  /    \ / _` | '__/ __|/ __|
# / /\/\ \ (_| | |  \__ \ (__ 
# \/    \/\__, |_|  |___/\___|
#         |___/               
# Have fun. Don't forget to



import random
from openpyxl import Workbook

people = ['shf', 'fjz', 'pyy', 'mk', 'gxz', 'yzg', 'ls', 'wjt', 'xt', 'yl', 'gjh', 'hx', 'yx', 'hml', 
          'lch', 'lyx', 'xzy', 'zp', 'jhn', 'hlp', 'cy', 'caiy', 'djx', 'lhm', 'lzy', 'rxy', 'ty', 
          'zgf', 'zwy', 'zxr', 'byh', 'lian', 'lsj', 'zzk']

groups = []

# Loop through each group
for i in range(21):
    # Create a new group
    group = []
    
    # Add one person to the current group, ensuring that each person is assigned to at least one group
    if i < len(people):
        person = people[i]
        group.append(person)
    else:
        while True:
            # Randomly select a person who has not already been added to this group more than twice
            person = random.choice(people)
            if sum([group.count(p) for p in group + [person]]) < 3:
                break
        
        group.append(person)
    
    # Add two more people to the current group
    for j in range(2):
        while True:
            # Randomly select a person who has not already been added to this group more than twice
            person = random.choice(people)
            if sum([group.count(p) for p in group + [person]]) < 3:
                break
        
        group.append(person)
    
    # Add the new group to the list of groups
    groups.append(group)
    
    # Remove the assigned people from the list of remaining people
    for person in group:
        people.remove(person)

# Handle any remaining people who have not been assigned to a group
remaining_people = list(set(people))
random.shuffle(remaining_people)
while remaining_people:
    # Add another group and assign three people to it, taking from the remaining_people list
    group = remaining_people[:3]
    remaining_people = remaining_people[3:]
    groups.append(group)

# Output the groups to an Excel file
wb = Workbook()
ws = wb.active
for i, group in enumerate(groups):
    ws.cell(row=i+1, column=1, value=f"Group {i+1}: {', '.join(group)}")
wb.save('group_results.xlsx')
